07.04.20
1)Добавить новые команды UART
Комманда от контроллера:
ping;
Ответ от процессора:
ping OK;
Описание:
Комманда посылается контроллером процессору для проверки работоспособности. Интервал - 60с. В случае, если 3 отправленных комманды не получают ответа - происходит перезагрузка модуля
методом подачи 0 на OPI_ON(PIO3_0) в течении 10с, и подачи 1.

Комманда от процессора:
restart;
Ответ от контроллера:
restart OK;
Описание:
Перезагрузка процессорного модуля.После получения комманды контроллер ждет 30с, и после этого подает 0 на OPI_ON(PIO3_0) в течении 10с, и потом 1 на OPI_ON(PIO3_0)

Комманда от процессора:
restart_all;
Ответ от контроллера:
restart_all OK;
Описание:
Перезагрузка процессорного модуля и процессора.После получения комманды контроллер ждет 30с, и после этого подает 0 на OPI_ON(PIO3_0) в течении 10с, и после этого перезагружает себя. Дальнейшая загрузка идет по стандартному
алгоритму загрузки после включения питания

Комманда от процессора:
cam1_restart;
Ответ от контроллера:
cam1_restart OK;
Описание:
Перезагрузка камеры 1.Подача нуля на CAM1_ON,ожидание 10с, подача единицы

Комманда от процессора:
cam2_restart;
Ответ от контроллера:
cam2_restart OK;
Описание:
Перезагрузка камеры 2.Подача нуля на CAM2_ON,ожидание 10с, подача единицы

Комманда от процессора:
cam3_restart;
Ответ от контроллера:
cam3_restart OK;
Описание:
Перезагрузка камеры 3.Подача нуля на CAM3_ON,ожидание 10с, подача единицы

Комманда от процессора:
cam4_restart;
Ответ от контроллера:
cam4_restart OK;
Описание:
Перезагрузка камеры 4.Подача нуля на CAM4_ON,ожидание 10с, подача единицы


Если есть возможность проверки устройств на шине CAN - то нужна комманда, которой можно запросить какие устройства есть на шине.


2)Поменять пины управления камерами на заданные
CAM1 PIO0_2 на PIO1_8
CAM2 PIO2_1 на PIO2_7
CAM3 PIO0_4 на PIO2_8
CAM4 PIO0_5 на PIO2_1
3)Добавить датчик зажигания PIO0_7 IGNITION
Алгоритм работы следующий:
При подаче на него 1 происходит включение пина OPI_ON(PIO3_0). При 0 на этом пине происходит отправка в UART сообщения ignition_off;(ответ ignition_off OK;), и после заданного параметром интервала
происходит выключение пинов камер и отправка в UART комманды shutdown;. После отправки комманды на выключение происходит пауза в 30с и выставление на пине OPI_ON 0

4)Добавить Sleep mode в случае наличия датчика зажигания